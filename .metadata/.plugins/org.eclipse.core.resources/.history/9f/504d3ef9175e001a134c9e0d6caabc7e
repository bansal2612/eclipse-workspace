package com.birlasoft.automation.tests.client;

import java.io.File;
import java.io.IOException;
import java.lang.reflect.Method;
import java.util.List;
import java.util.NoSuchElementException;
import java.util.Random;
import java.util.concurrent.TimeUnit;

import org.openqa.selenium.By;
import org.openqa.selenium.Dimension;
import org.openqa.selenium.StaleElementReferenceException;
import org.openqa.selenium.WebDriver;
import org.openqa.selenium.WebElement;
import org.openqa.selenium.support.PageFactory;
import org.openqa.selenium.support.ui.ExpectedCondition;
import org.openqa.selenium.support.ui.ExpectedConditions;
import org.openqa.selenium.support.ui.WebDriverWait;
import org.testng.Assert;
import org.testng.ITestResult;
import org.testng.annotations.AfterMethod;
import org.testng.annotations.AfterSuite;
import org.testng.annotations.AfterTest;
import org.testng.annotations.BeforeMethod;
import org.testng.annotations.BeforeSuite;
import org.testng.annotations.BeforeTest;
import org.testng.annotations.DataProvider;
import org.testng.annotations.Ignore;
import org.testng.annotations.Test;

import com.birlasoft.automation.driver.TestConfig;
import com.birlasoft.automation.driver.TestData;
import com.birlasoft.automation.driver.TestDriver;
import com.birlasoft.automation.uipages.AssigneePage;
import com.birlasoft.automation.uipages.ClientsPage;
import com.birlasoft.automation.uipages.HomePage;
import com.birlasoft.automation.uipages.LoginPage;
import com.birlasoft.framework.ExtentManager;
import com.birlasoft.framework.LogMe;
import com.birlasoft.utils.DataLoaders;
import com.birlasoft.utils.UIUtils;
import com.relevantcodes.extentreports.LogStatus;

public class TestsClient {
	static LogMe LOGGER;
	private WebDriver driver;
	LoginPage login;
	HomePage home;
	WebDriverWait wait;	
	Random rand;

	@BeforeSuite
	public void suiteSetup() {
		
		try {
			LOGGER = new LogMe(TestsClient.class);
			TestConfig.getInstance().suiteSetup();
		} catch (Exception e) {
			LOGGER.logError("Exception " + e.getClass().getName() + " caught from suite setup method", e);
		}
		
	}

	@BeforeTest
	public void testSetup() throws Exception {
		
		
		
		
		
	}

	@BeforeMethod
	public void startReporting(Method method) throws Exception {
		driver = TestDriver.driverInstantiation(TestConfig.getInstance().getBrowserName().toUpperCase());
		LogMe.getLogger().info("Base URL is " + TestConfig.getInstance().getAppBaseURL());

		LOGGER.logInfo("*********EXECUTION STARTED**********\n\n");

		driver.get(TestConfig.getInstance().getAppBaseURL());

		driver.manage().timeouts().implicitlyWait(30, TimeUnit.SECONDS);
		driver.manage().timeouts().pageLoadTimeout(30, TimeUnit.SECONDS);
		driver.manage().timeouts().setScriptTimeout(30, TimeUnit.SECONDS);
		UIUtils.waitForPageLoad(driver);
		if (!TestConfig.getInstance().getDeviceResolution().equals("Full Screen")) {
			String[] dim = TestConfig.getInstance().getDeviceResolution().split(",");
			int dimX = Integer.parseInt(dim[0]);
			int dimY = Integer.parseInt(dim[1]);
			Dimension d = new Dimension(dimX, dimY);
			driver.manage().window().setSize(d);
		} else {
			driver.manage().window().maximize();
		}

		// Login into the application
		login = PageFactory.initElements(driver, LoginPage.class);

		// Validation whether login is displaying or not
		Assert.assertTrue(login.isPageOpen());
        
		// Trying to login into the application
		home = login.login(TestConfig.getDataConfig().getPropertyValue("userName"),
		TestConfig.getDataConfig().getPropertyValue("secret"));
		wait=new WebDriverWait(driver, 80);
		rand=new Random();
		LOGGER.logBeginTestCase(method.getName());
		Assert.assertTrue(home.isPageOpen());
		LOGGER.logTestStep("PASS", "Home page is displaying");
	}

	
      @Test(description = "Client Update test with email field only.",enabled = false,priority = 1,dataProvider = "getClientData", groups= {"Regression", "Client"})
	  public void tc01_Client_ClientUpdate(String client, String clientNumber, String country, String status) throws Exception
	    {		
		   LOGGER.logInfo("Client Update test with email field only.");
		   ClientsPage clientpage=home.clickClients();
		   //Validation for Client page loading.
		   Assert.assertTrue(clientpage.isPageOpen());
		   LOGGER.logTestStep("PASS", "Client page is displaying properly");
		   //Validation for Search result for client on the basis of given client name.
		   Assert.assertTrue(clientpage.searchClient(client, clientNumber, country, status));
		   LOGGER.logTestStep("PASS", "Client Profile is displayed");
		   UIUtils.clickElement(driver, TestConfig.getInstance().getObjRep().getLocator("Client", "anchorLink"));
		   wait.until(ExpectedConditions.invisibilityOf(driver.findElement(TestConfig.getInstance().getObjRep().getLocator("Client", "anchorLink"))));
		   UIUtils.waitForPageLoad(driver);
		   clientpage.getWork_top();
		   String email="updatedTestEmail" + rand.nextInt(1000) + "@sirva.com";
		   UIUtils.inputText(driver,TestConfig.getInstance().getObjRep().getLocator("Client", "email") , email);
		   clientpage.getMyBarFrame();
		   UIUtils.clickElement(driver,TestConfig.getInstance().getObjRep().getLocator("Client", "save"));
		   Thread.sleep(10000);
		   driver.switchTo().defaultContent();
		   clientpage.getWork_top();
		   //Validations for verifying the updated client email
		   Assert.assertEquals(UIUtils.findElement(driver, TestConfig.getInstance().getObjRep().getLocator("Client", "email")).getAttribute("value"), email, "Email is successfully Updated");
		   LOGGER.logTestStep("PASS", "Client Profile updated");
		  
	}
		
	  @Test(description ="Add new Client", enabled=false, priority=1, groups= {"Regression","Client"}) 
	  public void tc02_AddNewClient() throws Exception {
	  LOGGER.logInfo("TC02_Add New Client test case started"); 
	  ClientsPage clientpage=home.clickClients(); 
	  Assert.assertTrue(clientpage.isPageOpen());
	  clientpage.getWork_top_AddnewClient();
	  UIUtils.clickElement(driver,TestConfig.getInstance().getObjRep().getLocator("Client", "Addnew"));
	  clientpage.getWork_top();
	  UIUtils.inputText(driver, TestConfig.getInstance().getObjRep().getLocator("Newclient","Name"), TestData.getData("AddClient").get("Name").toString() + rand.nextInt(1000));
	  UIUtils.inputText(driver, TestConfig.getInstance().getObjRep().getLocator("Newclient","Legal"), TestData.getData("AddClient").get("LegalName").toString() + rand.nextInt(1000));
	  UIUtils.selectValue(driver, TestConfig.getInstance().getObjRep().getLocator("Newclient","Accmanag"), "text", TestData.getData("AddClient").get("AccountManager").toString());
	  UIUtils.selectValue(driver, TestConfig.getInstance().getObjRep().getLocator("Newclient","Status"), "text", TestData.getData("AddClient").get("Status").toString());
	  UIUtils.clickElement(driver, TestConfig.getInstance().getObjRep().getLocator("Newclient","Begin"));
	  UIUtils.waitUntilElementExists(driver, TestConfig.getInstance().getObjRep().getLocator("Newclient","Currentdate"), 10);
	  UIUtils.clickElement(driver, TestConfig.getInstance().getObjRep().getLocator("Newclient","Currentdate"));
	  UIUtils.inputText(driver, TestConfig.getInstance().getObjRep().getLocator("Newclient","Address1"), TestData.getData("AddClient").get("Address1").toString() + rand.nextInt(100));
	  UIUtils.inputText(driver, TestConfig.getInstance().getObjRep().getLocator("Newclient","Address2"), TestData.getData("AddClient").get("Address2").toString() + rand.nextInt(100));
	  UIUtils.selectValue(driver, TestConfig.getInstance().getObjRep().getLocator("Newclient","Country"), "text", TestData.getData("AddClient").get("Country").toString());
	  UIUtils.inputText(driver, TestConfig.getInstance().getObjRep().getLocator("Newclient","City"), TestData.getData("AddClient").get("City").toString() + rand.nextInt(100));
	  UIUtils.selectValue(driver, TestConfig.getInstance().getObjRep().getLocator("Newclient","State"), "text", TestData.getData("AddClient").get("State").toString());
	  UIUtils.inputText(driver, TestConfig.getInstance().getObjRep().getLocator("Newclient","Postalcode"), TestData.getData("AddClient").get("PostalCode").toString());
	  UIUtils.clickElement(driver, TestConfig.getInstance().getObjRep().getLocator("Newclient","Masterfields"));
	  System.out.println("First Part done");
	  driver.switchTo().frame("did_master_fields");
	  System.out.println("Second part done");
	  UIUtils.selectValue(driver,TestConfig.getInstance().getObjRep().getLocator("Masterfields","SirvaBU"), "text", TestData.getData("AddClient").get("SirvaBuisnessUnit").toString());
	  UIUtils.selectValue(driver,TestConfig.getInstance().getObjRep().getLocator("Masterfields","Financialsys"), "text", TestData.getData("AddClient").get("FinancialSystem").toString());
	  clientpage.getMyBarFrame();
	  System.out.println("Third Part done");
	  UIUtils.clickElement(driver,TestConfig.getInstance().getObjRep().getLocator("Client", "save"));
	  driver.switchTo().defaultContent();
	  clientpage.getWork_top_AddnewClient();
	  wait.until(ExpectedConditions.visibilityOf(driver.findElement(By.xpath("//a[text()='Divisions']"))));	 
	  UIUtils.clickElement(driver, TestConfig.getInstance().getObjRep().getLocator("Newclient", "Clienttype"));
	  Thread.sleep(5000);
	  driver.switchTo().defaultContent();
	    int i=1; 
		  while(i<10000) 
		  {
			  if(driver.findElement(By.xpath("//div[@id='did_appframe_display']/preceding::div[@id='styled_popup_1']/div[@class='dmode_iframe_container']")).isDisplayed())
			  {
				  break;
			  }
			  else 
				  i=i+1;
		  
		  }
		  System.out.println(i);
	  driver.switchTo().frame(driver.findElement(TestConfig.getInstance().getObjRep().getLocator("Main", "Modalxpath")));
	  driver.switchTo().frame("frame_detail");
	  i=1; 
	  while(i<20000) 
	  {
		  if(driver.findElement(By.xpath("//label[text()='Client Connection Authorized']")).isDisplayed())
		  {
			  break;
		  }
		  else 
			  i=i+1;
	  
	  }
	  UIUtils.clickElement(driver, TestConfig.getInstance().getObjRep().getLocator("Clienttype", "ConnectionAuthorized"));
	  UIUtils.clickElement(driver, TestConfig.getInstance().getObjRep().getLocator("Clienttype", "SirvaConnect"));
	  UIUtils.clickElement(driver, TestConfig.getInstance().getObjRep().getLocator("Clienttype", "SirvaConnectEmp"));
	  UIUtils.clickElement(driver, TestConfig.getInstance().getObjRep().getLocator("Clienttype", "OnlineExpenses"));
	  driver.switchTo().parentFrame();
	  wait.until(ExpectedConditions.frameToBeAvailableAndSwitchToIt("frame_hdr"));
	  UIUtils.clickElement(driver, TestConfig.getInstance().getObjRep().getLocator("Clienttype", "Okbutton"));
	  Thread.sleep(10000);
	  driver.switchTo().defaultContent();
	  wait.until(ExpectedConditions.frameToBeAvailableAndSwitchToIt(driver.findElement(TestConfig.getInstance().getObjRep().getLocator("App", "Appframe"))));
	  driver.switchTo().frame("myBar");
      UIUtils.clickElement(driver,TestConfig.getInstance().getObjRep().getLocator("Client", "save"));
      Thread.sleep(5000);
      clientpage.getSummaryDetailsFrame();
      UIUtils.clickElement(driver, TestConfig.getInstance().getObjRep().getLocator("Newclient", "Finance"));
      driver.switchTo().defaultContent();
      wait.until(ExpectedConditions.frameToBeAvailableAndSwitchToIt("did_task_gadget_iframe"));
      UIUtils.clickElement(driver, TestConfig.getInstance().getObjRep().getLocator("Financetab", "Billing"));
      driver.switchTo().defaultContent();
      System.out.println("Entered into add new client frame");
      clientpage.getWork_top_AddnewClient();
      System.out.println("Entered into add new client frame1");
      UIUtils.clickElement(driver, TestConfig.getInstance().getObjRep().getLocator("Billing", "Active"));    
      UIUtils.clickElement(driver, TestConfig.getInstance().getObjRep().getLocator("Billing", "Batchinvoice"));      
      UIUtils.selectValue(driver, TestConfig.getInstance().getObjRep().getLocator("Billing","Taxstatus"), "text", TestData.getData("AddClient").get("TaxStatus").toString());
      UIUtils.clickElement(driver, TestConfig.getInstance().getObjRep().getLocator("Billing", "Paid"));   
      UIUtils.selectValue(driver, TestConfig.getInstance().getObjRep().getLocator("Billing","Terms"), "text", TestData.getData("AddClient").get("Terms").toString());
      UIUtils.selectValue(driver, TestConfig.getInstance().getObjRep().getLocator("Billing","Invoice"), "text", "Global Invoice Template1 (5.0.123)");
      clientpage.getMyBarFrame();
	  UIUtils.clickElement(driver,TestConfig.getInstance().getObjRep().getLocator("Client", "save"));  
	  
	  }
	  
	  @Test(description="Add new Program", priority=1, enabled=false, groups= {"Regression","Client"})
	  public void TC03_addProgram() throws Exception
	  {
		  LOGGER.logInfo("TC03_Add program test case started");
		  ClientsPage clientpage=home.clickClients();
		  //Validation for Client page is displayed
		  Assert.assertTrue(clientpage.isPageOpen());
		  LOGGER.logTestStep("PASS", "Client Page is displayed");
		  clientpage.getWork_top_AddnewClient();
		  UIUtils.inputText(driver, TestConfig.getInstance().getObjRep().getLocator("Client", "txtClient"), "Test Client New");
		  driver.switchTo().defaultContent();
	      wait.until(ExpectedConditions.frameToBeAvailableAndSwitchToIt("did_appframe"));
	      driver.switchTo().frame("work");		
		  driver.switchTo().frame("svc_select_btns");
          UIUtils.clickElement(driver, TestConfig.getInstance().getObjRep().getLocator("Assignee", "btnSearch")); //ClientSearch 
          clientpage.getWork_bottom();
          //Validation for Client search result.
          Assert.assertTrue(driver.findElement(TestConfig.getInstance().getObjRep().getLocator("Client", "anchorLink")).isDisplayed(), "Not able to search client. Please retry");
          LOGGER.logTestStep("PASS", "Client search Result is coming properly");
          UIUtils.clickElement(driver, TestConfig.getInstance().getObjRep().getLocator("Client", "anchorLink"));
          clientpage.getSummaryButtons();
          UIUtils.clickElement(driver, TestConfig.getInstance().getObjRep().getLocator("Newclient", "Programs"));
          driver.switchTo().defaultContent();
          driver.switchTo().frame(driver.findElement(TestConfig.getInstance().getObjRep().getLocator("Newclient", "Addprogram")));
          UIUtils.clickElement(driver, TestConfig.getInstance().getObjRep().getLocator("Programs", "Addprogram"));
          Thread.sleep(20000);
          driver.switchTo().defaultContent();
          wait.until(ExpectedConditions.frameToBeAvailableAndSwitchToIt(driver.findElement(By.xpath("//div[@id='styled_popup_1']/div[@class='dmode_iframe_container']/iframe"))));
          driver.switchTo().frame("mechparent");
          driver.switchTo().frame("mech_work");
          wait.until(ExpectedConditions.visibilityOf(driver.findElement(By.xpath("//textarea[@name='description']"))));
          //Validation of Program Mechanic displayed
          Assert.assertTrue(driver.findElement(By.xpath("//textarea[@name='description']")).isDisplayed(),"Error in displaying Program Mechanic: Step Click on Add Program");
          LOGGER.logTestStep("PASS", "Program Mechanic displayed successfully.");
          UIUtils.clickElement(driver, TestConfig.getInstance().getObjRep().getLocator("Programs", "Programmech"));
          Thread.sleep(30000);
          driver.switchTo().defaultContent();
          wait.until(ExpectedConditions.frameToBeAvailableAndSwitchToIt(driver.findElement(By.xpath("//div[@id='styled_popup_2']/div[@class='dmode_iframe_container']/iframe"))));
          driver.switchTo().frame("work_nav");
          Thread.sleep(30000);
          int i=1;
          while(i<100000)
          {
        	  if(driver.findElement(TestConfig.getInstance().getObjRep().getLocator("Programs", "Programcopy")).isDisplayed())
        	  {
        		  //Validation for Program copy window displayed
        		  LOGGER.logTestStep("PASS", "Program copy window displayed successfully.");
        		  break;
        	  }
        	  else 
        		  i=i+1;
          }
          UIUtils.inputText(driver, TestConfig.getInstance().getObjRep().getLocator("Programs", "Programcopy"), TestData.getData("AddClient").get("Programcopy").toString());
          UIUtils.clickElement(driver, TestConfig.getInstance().getObjRep().getLocator("Programs", "Find"));
          i=1;
          while(i<100000)
          {
        	  if(driver.findElement(TestConfig.getInstance().getObjRep().getLocator("Programs", "Result")).isDisplayed())
        	  {
        		  break;
        	  }
        	  else 
        		  i=i+1;
          }
          Thread.sleep(5000);
          UIUtils.clickElement(driver, TestConfig.getInstance().getObjRep().getLocator("Programs", "Result"));
          Thread.sleep(5000);
          driver.switchTo().defaultContent();
          i=1;
          while(i<100000)
          {
        	  if(driver.findElement(By.xpath("//div[@id='did_se_confirm_div']//td[@id='did_confirm_buttons']/input[@value='Yes']")).isDisplayed())
        	  {
        		  break;
        	  }
        	  else 
        		  i=i+1;
          }
          UIUtils.clickElement(driver, By.xpath("//div[@id='did_se_confirm_div']//td[@id='did_confirm_buttons']/input[@value='Yes']"));
          wait.until(ExpectedConditions.alertIsPresent());
          //Validation for Confirmation required box displayed.
          Assert.assertTrue(UIUtils.isAlertPresentSE(driver), "Confirmation required Alert box is not displayed");
          LOGGER.logTestStep("PASS", "Confirmation required Alert box displayed successfully");
          UIUtils.alertAccept(driver);
          wait.until(ExpectedConditions.frameToBeAvailableAndSwitchToIt("did_appframe"));
  		  driver.switchTo().frame("summaryButtons");
  		  UIUtils.clickElement(driver, By.xpath("//td[contains(text(),'20th Century')]"));
  		  Thread.sleep(30000);
  		  driver.switchTo().defaultContent();
  		  wait.until(ExpectedConditions.frameToBeAvailableAndSwitchToIt(driver.findElement(By.xpath("//div[@id='styled_popup_1']/div[@class='dmode_iframe_container']/iframe"))));
          driver.switchTo().frame("mechparent");
          driver.switchTo().frame("mech_work");
          UIUtils.inputText(driver, TestConfig.getInstance().getObjRep().getLocator("Testpolicy", "ProgramName"), TestData.getData("AddClient").get("Programname").toString() + rand.nextInt(1000));
          UIUtils.clickElement(driver, By.xpath("//td[contains(text(),'Active')]/following-sibling::td/input"));
          UIUtils.selectValue(driver, By.xpath("//td[contains(text(),'Program Type')]/following-sibling::td/select"), "text", TestData.getData("AddClient").get("Programtype").toString());
          UIUtils.inputText(driver, By.xpath("//td[contains(text(),'From')]/input"), UIUtils.getCurrentDate("MM/dd/yyyy"));
          UIUtils.getCurrentDate("MM/dd/yyyy");
          driver.switchTo().parentFrame();
          driver.switchTo().frame("mech_header");
          UIUtils.clickElement(driver, By.xpath("//input[@value='Save']"));
          //Thread.sleep(15000);
          wait.until(ExpectedConditions.elementToBeClickable(driver.findElement(TestConfig.getInstance().getObjRep().getLocator("Testpolicy", "Save"))));
          wait.until(ExpectedConditions.elementToBeClickable(driver.findElement(TestConfig.getInstance().getObjRep().getLocator("Testpolicy", "Print"))));
          driver.switchTo().parentFrame();
          driver.switchTo().frame("mech_work");
          wait.until(ExpectedConditions.visibilityOf(driver.findElement(By.xpath("//a[contains(text(),'Click here to preview')]"))));
          String name=driver.findElement(By.xpath("//td[contains(text(),'Program Name')]/following-sibling::td/input")).getAttribute("value") + "updated";
          UIUtils.inputText(driver, By.xpath("//td[contains(text(),'Program Name')]/following-sibling::td/input"), name);
          driver.switchTo().parentFrame();
          driver.switchTo().frame("mech_header");
          UIUtils.clickElement(driver, By.xpath("//input[@value='Save']"));
          //Thread.sleep(20000);
          wait.until(ExpectedConditions.elementToBeClickable(driver.findElement(TestConfig.getInstance().getObjRep().getLocator("Testpolicy", "Save"))));
          wait.until(ExpectedConditions.elementToBeClickable(driver.findElement(TestConfig.getInstance().getObjRep().getLocator("Testpolicy", "Print"))));
          WebElement close=wait.until(ExpectedConditions.presenceOfElementLocated(By.xpath("//input[@value='Close']")));
          close.click();
          Thread.sleep(10000);	
          driver.switchTo().defaultContent();
          wait.until(ExpectedConditions.frameToBeAvailableAndSwitchToIt(driver.findElement(By.xpath("//div[@id='did_appframe_display']/iframe"))));
          driver.switchTo().frame("cp_display");
          UIUtils.clickElement(driver, By.xpath("//span[text()='Assignee']"));
          driver.switchTo().defaultContent();
          clientpage.getWork_top_AddnewClient();
          UIUtils.clickElement(driver, TestConfig.getInstance().getObjRep().getLocator("Client", "Addnew"));
          driver.switchTo().defaultContent();
          clientpage.getWork_top_AddnewClient();
          UIUtils.inputText(driver.findElement(By.xpath("//input[@id='Text1']")), "John");
          UIUtils.inputText(driver.findElement(By.xpath("//input[@id='Text3']")), "Smith");
          UIUtils.clickElement(driver, TestConfig.getInstance().getObjRep().getLocator("NewClient", "Clientlink"));
          driver.switchTo().defaultContent();
          i=1; 
		  while(i<10000) 
		  {
			  if(driver.findElement(By.xpath("//div[@id='did_appframe_display']/preceding::div[@id='styled_popup_1']/div[@class='dmode_iframe_container']")).isDisplayed())
			  {
				  break;
			  }
			  else 
				  i=i+1;
		  
		  }
		  wait.until(ExpectedConditions.frameToBeAvailableAndSwitchToIt(driver.findElement(TestConfig.getInstance().getObjRep().getLocator("Main", "Modalxpath"))));
		  wait.until(ExpectedConditions.frameToBeAvailableAndSwitchToIt("did_appframe"));
		  wait.until(ExpectedConditions.frameToBeAvailableAndSwitchToIt("work_top"));
		  UIUtils.inputText(driver.findElement(By.xpath("//td[starts-with(text(),'Client')]/preceding-sibling::td/input")), "Test Client New");
		  driver.switchTo().parentFrame();
		  driver.switchTo().frame("svc_select_btns");
		  UIUtils.clickElement(driver, By.xpath("//input[@value='Search' and @name='button1']"));
		  driver.switchTo().parentFrame();
		  wait.until(ExpectedConditions.visibilityOf(driver.findElement(By.xpath("//frame[starts-with(@name,'work_bottom') and contains(@src,'blank')]"))));
		  wait.until(ExpectedConditions.frameToBeAvailableAndSwitchToIt(driver.findElement(By.xpath("//frame[starts-with(@name,'work_bottom') and contains(@src,'blank')]"))));
		  UIUtils.clickElement(driver, TestConfig.getInstance().getObjRep().getLocator("Client", "anchorLink"));
		  driver.switchTo().defaultContent();
		  clientpage.getWork_top_AddnewClient();
		  String toTest=name + " (Test Client New)";
		  //Validation for Program added in step 25 should be available in the drop down
		  Assert.assertTrue(UIUtils.checkTextInDropdown(driver.findElement(By.xpath("//td[@id='did_program']/select")), toTest));
		  LOGGER.logTestStep("PASS", "Newly added program is coming successfully");
	  }
	
	  @Test(description=" Inactivate Program Add assignee", enabled=false, priority=1, groups= {"Regression","Client"})
	  public void TC_04_Inactivate_Program_Add_assignee() throws Exception
	  {
		  LOGGER.logInfo("TC04_ Inactivate Program Add assignee");
		  ClientsPage clientpage=home.clickClients();
		  Assert.assertTrue(clientpage.isPageOpen());
		  LOGGER.logTestStep("PASS", "Client page is displaying properly");
		  clientpage.getWork_top_AddnewClient();
		  UIUtils.inputText(driver, TestConfig.getInstance().getObjRep().getLocator("Client", "txtClient"), "Test Client New");
		  driver.switchTo().defaultContent();
	      wait.until(ExpectedConditions.frameToBeAvailableAndSwitchToIt("did_appframe"));
	      driver.switchTo().frame("work");		
		  driver.switchTo().frame("svc_select_btns");
          UIUtils.clickElement(driver, TestConfig.getInstance().getObjRep().getLocator("Assignee", "btnSearch"));
          clientpage.getWork_bottom();
          //Validation for Client search result.
          Assert.assertTrue(driver.findElement(TestConfig.getInstance().getObjRep().getLocator("Client", "anchorLink")).isDisplayed(), "Not able to search client. Please retry");
          LOGGER.logTestStep("PASS", "Client Profile displayed successfully");
          UIUtils.clickElement(driver, TestConfig.getInstance().getObjRep().getLocator("Client", "anchorLink"));
          clientpage.getSummaryButtons();
          UIUtils.clickElement(driver, TestConfig.getInstance().getObjRep().getLocator("TestClientNew", "Testpolicy"));
          Thread.sleep(20000);
          driver.switchTo().defaultContent();
          wait.until(ExpectedConditions.frameToBeAvailableAndSwitchToIt(driver.findElement(By.xpath("//div[@id='styled_popup_1']/div[@class='dmode_iframe_container']/iframe"))));
          driver.switchTo().frame("mechparent");
          driver.switchTo().frame("mech_work");
          wait.until(ExpectedConditions.visibilityOf(driver.findElement(By.xpath("//textarea[@name='description']"))));
          String Policyname=UIUtils.findElement(driver, TestConfig.getInstance().getObjRep().getLocator("Testpolicy", "ProgramName")).getAttribute("value");
          System.out.println(Policyname);
          //Validation of Program Mechanic displayed
          Assert.assertTrue(driver.findElement(By.xpath("//textarea[@name='description']")).isDisplayed(),"Error in displaying Program Mechanic: Program Mechanic displayed");
          LOGGER.logTestStep("PASS", "Program Mechanic displayed successfully.");
          //Validation for unchecking the Active checkbox on Test Policy
          if(driver.findElement(TestConfig.getInstance().getObjRep().getLocator("Testpolicy", "Active")).isSelected()==true)
          {
        	  UIUtils.clickElement(driver, TestConfig.getInstance().getObjRep().getLocator("Testpolicy", "Active"));
        	  LOGGER.logTestStep("PASS", "Program now inactive successfully.");
          }
          else
          {
        	  LOGGER.logTestStep("PASS", "Active checkbox was already un-checked");
          }
          driver.switchTo().parentFrame();
          driver.switchTo().frame("mech_header");
          UIUtils.clickElement(driver, TestConfig.getInstance().getObjRep().getLocator("Testpolicy", "Save"));
          wait.until(ExpectedConditions.elementToBeClickable(driver.findElement(TestConfig.getInstance().getObjRep().getLocator("Testpolicy", "Save"))));
          wait.until(ExpectedConditions.elementToBeClickable(driver.findElement(TestConfig.getInstance().getObjRep().getLocator("Testpolicy", "Print"))));
          UIUtils.clickElement(driver, TestConfig.getInstance().getObjRep().getLocator("Testpolicy", "Close"));
          wait.until(ExpectedConditions.invisibilityOf(driver.findElement(TestConfig.getInstance().getObjRep().getLocator("Testpolicy", "Close"))));
          driver.switchTo().defaultContent();
          wait.until(ExpectedConditions.frameToBeAvailableAndSwitchToIt(driver.findElement(TestConfig.getInstance().getObjRep().getLocator("Main", "FirstIframe"))));
          driver.switchTo().frame("cp_display");
          wait.until(ExpectedConditions.elementToBeClickable(TestConfig.getInstance().getObjRep().getLocator("Common", "menuAssignee")));
          UIUtils.clickElement(driver, TestConfig.getInstance().getObjRep().getLocator("Common", "menuAssignee"));
          driver.switchTo().defaultContent();
          clientpage.getWork_top_AddnewClient();
          UIUtils.clickElement(driver, TestConfig.getInstance().getObjRep().getLocator("Client", "Addnew"));
          wait.until(ExpectedConditions.invisibilityOf(driver.findElement(TestConfig.getInstance().getObjRep().getLocator("Client", "Addnew"))));
          System.out.println("Add new appeared");
          driver.switchTo().defaultContent();
          clientpage.getWork_top_AddnewClient();
          System.out.println("Entered frame");
          wait.until(ExpectedConditions.visibilityOf(driver.findElement(TestConfig.getInstance().getObjRep().getLocator("NewClient", "Clientlink"))));
          System.out.println("Element visivble");
          //Validation for Client link is clickable on New client page
          Assert.assertTrue(UIUtils.findElement(driver, TestConfig.getInstance().getObjRep().getLocator("NewClient", "Clientlink")).isEnabled(), "Client Button is not clickable or either disabled");
          LOGGER.logTestStep("PASS", "Search Client is working correctly");
          UIUtils.clickElement(driver, TestConfig.getInstance().getObjRep().getLocator("NewClient", "Clientlink"));
          driver.switchTo().defaultContent();
          int i=1; 
		  while(i<10000) 
		  {
			  if(driver.findElement(TestConfig.getInstance().getObjRep().getLocator("NewClient", "ClientModal")).isDisplayed())
			  {
				  break;
			  }
			  else 
				  i=i+1;
		  
		  }
		  wait.until(ExpectedConditions.frameToBeAvailableAndSwitchToIt(driver.findElement(TestConfig.getInstance().getObjRep().getLocator("Main", "Modalxpath"))));
		  wait.until(ExpectedConditions.frameToBeAvailableAndSwitchToIt("did_appframe"));
		  wait.until(ExpectedConditions.frameToBeAvailableAndSwitchToIt("work_top"));
		  UIUtils.inputText(driver.findElement(By.xpath("//td[starts-with(text(),'Client')]/preceding-sibling::td/input")), "Test Client New");
		  driver.switchTo().parentFrame();
		  driver.switchTo().frame("svc_select_btns");
		  UIUtils.clickElement(driver, By.xpath("//input[@value='Search' and @name='button1']"));
		  driver.switchTo().parentFrame();
		  wait.until(ExpectedConditions.visibilityOf(driver.findElement(By.xpath("//frame[starts-with(@name,'work_bottom') and contains(@src,'blank')]"))));
		  wait.until(ExpectedConditions.frameToBeAvailableAndSwitchToIt(driver.findElement(By.xpath("//frame[starts-with(@name,'work_bottom') and contains(@src,'blank')]"))));
		  UIUtils.clickElement(driver, TestConfig.getInstance().getObjRep().getLocator("Client", "anchorLink"));
		  driver.switchTo().defaultContent();
		  clientpage.getWork_top_AddnewClient();
		  Assert.assertFalse(UIUtils.checkTextInDropdown(driver.findElement(By.xpath("//td[@id='did_program']/select")), Policyname));
		  LOGGER.logTestStep("PASS", " Inactivate Program Add assignee executed successfully");
		  
      }
	  
	  @Test(description="UpdateProgramServices", enabled=false, priority=1, groups= {"Regression","Client"})
	  public void TC_05_UpdateProgramServices() throws Exception
	  {
		  
		   ClientsPage clientpage=home.clickClients(); 
		   Assert.assertTrue(clientpage.isPageOpen());
		   LOGGER.logTestStep("PASS", "Client page is displaying properly");
		   clientpage.getWork_top_AddnewClient();
		   UIUtils.inputText(driver, TestConfig.getInstance().getObjRep().getLocator("Client", "txtClient"), "Test Client New");
		   driver.switchTo().defaultContent();
		   wait.until(ExpectedConditions.frameToBeAvailableAndSwitchToIt("did_appframe"));
		   driver.switchTo().frame("work");		
		   driver.switchTo().frame("svc_select_btns");
	       UIUtils.clickElement(driver, TestConfig.getInstance().getObjRep().getLocator("Assignee", "btnSearch"));
	       clientpage.getWork_bottom();
	       //Validation for Client search result.
	       Assert.assertTrue(driver.findElement(TestConfig.getInstance().getObjRep().getLocator("Client", "anchorLink")).isDisplayed(), "Not able to search client. Please retry");
	       LOGGER.logTestStep("PASS", "Client Profile displayed successfully");
	       UIUtils.clickElement(driver, TestConfig.getInstance().getObjRep().getLocator("Client", "anchorLink"));
	       clientpage.getSummaryButtons();
	       UIUtils.clickElement(driver, TestConfig.getInstance().getObjRep().getLocator("TestClientNew", "TestpolicyUP"));
	       Thread.sleep(20000);
	       driver.switchTo().defaultContent();
	       wait.until(ExpectedConditions.frameToBeAvailableAndSwitchToIt(driver.findElement(By.xpath("//div[@id='styled_popup_1']/div[@class='dmode_iframe_container']/iframe"))));
	       driver.switchTo().frame("mechparent");
	       driver.switchTo().frame("mech_work");
	       wait.until(ExpectedConditions.visibilityOf(driver.findElement(By.xpath("//textarea[@name='description']"))));
	       String Policyname=UIUtils.findElement(driver, TestConfig.getInstance().getObjRep().getLocator("Testpolicy", "ProgramName")).getAttribute("value");
	       //Validation of Program Mechanic displayed
	       Assert.assertTrue(driver.findElement(By.xpath("//textarea[@name='description']")).isDisplayed(),"Error in displaying Program Mechanic: Program Mechanic displayed");
	       LOGGER.logTestStep("PASS", "Program Mechanic displayed successfully.");
	       driver.switchTo().parentFrame();
	       driver.switchTo().frame(driver.findElement(TestConfig.getInstance().getObjRep().getLocator("Testpolicy", "mechNavIframe")));
	       UIUtils.clickElement(driver, TestConfig.getInstance().getObjRep().getLocator("Testpolicy", "ServiceControlAcc"));
	       wait.until(ExpectedConditions.elementToBeClickable(TestConfig.getInstance().getObjRep().getLocator("Testpolicy", "Setup")));
	       Thread.sleep(20000);
	       driver.switchTo().parentFrame();
	       wait.until(ExpectedConditions.frameToBeAvailableAndSwitchToIt(driver.findElement(By.xpath("//frame[@name='mech_work']"))));
	       wait.until(ExpectedConditions.frameToBeAvailableAndSwitchToIt(By.xpath("//frame[@name='form_work']")));
	       driver.switchTo().defaultContent();
	       wait.until(ExpectedConditions.frameToBeAvailableAndSwitchToIt(driver.findElement(By.xpath("//div[@id='styled_popup_1']/div[@class='dmode_iframe_container']/iframe"))));
	       driver.switchTo().frame("mechparent");
	       driver.switchTo().frame("mech_work");
	       wait.until(ExpectedConditions.visibilityOf(driver.findElement(By.xpath("//frame[@name='form_work']"))));
	       wait.until(ExpectedConditions.frameToBeAvailableAndSwitchToIt(driver.findElement(By.xpath("//frame[@name='form_buttons']"))));
	       wait.until(ExpectedConditions.presenceOfElementLocated(By.xpath("//title[contains(text(),'SIRVA Gen3.71810 - Refresh Date')]")));
	       UIUtils.clickElement(driver, TestConfig.getInstance().getObjRep().getLocator("Testpolicy", "Deleteservice"));
	       System.out.println("Test");
	       driver.switchTo().defaultContent();
	       wait.until(ExpectedConditions.frameToBeAvailableAndSwitchToIt(UIUtils.findElement(driver, TestConfig.getInstance().getObjRep().getLocator("DeleteService", "iframe"), 60)));
	       Thread.sleep(5000);
	       wait.until(ExpectedConditions.frameToBeAvailableAndSwitchToIt("mainframe"));
	       if(UIUtils.isElementPresent(driver, TestConfig.getInstance().getObjRep().getLocator("DeleteService", "Checkbox")))
	       {
	       System.out.println("element present");	 
	       UIUtils.clickElement(driver, TestConfig.getInstance().getObjRep().getLocator("DeleteService", "Checkbox"));
	       }
	       System.out.println("element not present");
	       driver.switchTo().parentFrame();
	       driver.switchTo().frame("title_buttons");
	       UIUtils.clickElement(driver, TestConfig.getInstance().getObjRep().getLocator("DeleteService", "Okbutton"));
	       Thread.sleep(10000);
	       driver.switchTo().defaultContent();
	       System.out.println("Accepted");
	       wait.until(ExpectedConditions.frameToBeAvailableAndSwitchToIt(driver.findElement(By.xpath("//div[@id='styled_popup_1']/div[@class='dmode_iframe_container']/iframe"))));
	       driver.switchTo().frame("mechparent");
	       driver.switchTo().frame("mech_work");
	       wait.until(ExpectedConditions.frameToBeAvailableAndSwitchToIt(driver.findElement(By.xpath("//frame[@name='form_buttons']"))));
	       UIUtils.clickElement(driver, TestConfig.getInstance().getObjRep().getLocator("Testpolicy", "AddService"));
	       driver.switchTo().defaultContent();
	       LOGGER.logTestStep("PASS", "Add Service window displayed");
	       Assert.assertTrue(UIUtils.findElement(driver, TestConfig.getInstance().getObjRep().getLocator("Addservice", "YesButton")).isDisplayed(), "Add Service window displayed");
	       UIUtils.clickElement(driver, TestConfig.getInstance().getObjRep().getLocator("Addservice", "YesButton"));
	       driver.switchTo().defaultContent();
	       wait.until(ExpectedConditions.frameToBeAvailableAndSwitchToIt(UIUtils.findElement(driver, TestConfig.getInstance().getObjRep().getLocator("DeleteService", "iframe"), 60)));
	       Thread.sleep(5000);
	       wait.until(ExpectedConditions.frameToBeAvailableAndSwitchToIt("mainframe"));
	       UIUtils.clickElement(driver, TestConfig.getInstance().getObjRep().getLocator("Addservice", "Addservicebox"));
	       driver.switchTo().parentFrame();
	       driver.switchTo().frame("title_buttons");
	       UIUtils.clickElement(driver, TestConfig.getInstance().getObjRep().getLocator("DeleteService", "Okbutton"));
	       driver.switchTo().defaultContent();
	       LOGGER.logTestStep("PASS", "Validation for Copy added service(s) to other programs?");
	       Assert.assertTrue(UIUtils.findElement(driver, TestConfig.getInstance().getObjRep().getLocator("Addservice", "NoButton")).isDisplayed(), "Copy added service(s) to other programs? is not coming");
	       UIUtils.clickElement(driver, TestConfig.getInstance().getObjRep().getLocator("Addservice", "NoButton"));
	       driver.switchTo().defaultContent();
	       wait.until(ExpectedConditions.frameToBeAvailableAndSwitchToIt(UIUtils.findElement(driver, TestConfig.getInstance().getObjRep().getLocator("DeleteService", "iframe"), 60)));
	       driver.switchTo().frame("mechparent");
	       driver.switchTo().frame("mech_work");
	       wait.until(ExpectedConditions.visibilityOf(driver.findElement(By.xpath("//frame[@name='form_work']"))));
	       wait.until(ExpectedConditions.frameToBeAvailableAndSwitchToIt(driver.findElement(By.xpath("//frame[@name='form_buttons']"))));
	       wait.until(ExpectedConditions.presenceOfElementLocated(By.xpath("//title[contains(text(),'SIRVA Gen3.71810 - Refresh Date')]")));
	       UIUtils.clickElement(driver, TestConfig.getInstance().getObjRep().getLocator("Testpolicy", "Deleteservice"));
	       driver.switchTo().defaultContent();
	       wait.until(ExpectedConditions.frameToBeAvailableAndSwitchToIt(UIUtils.findElement(driver, TestConfig.getInstance().getObjRep().getLocator("DeleteService", "iframe"), 60)));
	       Thread.sleep(5000);
	       wait.until(ExpectedConditions.frameToBeAvailableAndSwitchToIt("mainframe"));
	       LOGGER.logTestStep("PASS", "Ancilliary and Asset Management Services added");
	       Assert.assertTrue(UIUtils.findElement(driver, TestConfig.getInstance().getObjRep().getLocator("DeleteService", "AnciliaryText")).isDisplayed(), "Workflow is not added properly");
	  }
	  
	  @Test(description="Program_MasterFields", enabled=false, priority=1, groups= {"Regression","Client"})
	  public void TC_06_Program_MasterFields() throws Exception
	  {
		  
		   ClientsPage clientpage=home.clickClients(); 
		   Assert.assertTrue(clientpage.isPageOpen());
		   LOGGER.logTestStep("PASS", "Client page is displaying properly");
		   clientpage.getWork_top_AddnewClient();
		   UIUtils.inputText(driver, TestConfig.getInstance().getObjRep().getLocator("Client", "txtClient"), "Test Client New");
		   driver.switchTo().defaultContent();
		   wait.until(ExpectedConditions.frameToBeAvailableAndSwitchToIt("did_appframe"));
		   driver.switchTo().frame("work");		
		   driver.switchTo().frame("svc_select_btns");
	       UIUtils.clickElement(driver, TestConfig.getInstance().getObjRep().getLocator("Assignee", "btnSearch"));
	       clientpage.getWork_bottom();
	       //Validation for Client search result.
	       Assert.assertTrue(driver.findElement(TestConfig.getInstance().getObjRep().getLocator("Client", "anchorLink")).isDisplayed(), "Not able to search client. Please retry");
	       LOGGER.logTestStep("PASS", "Client Profile displayed successfully");
	       UIUtils.clickElement(driver, TestConfig.getInstance().getObjRep().getLocator("Client", "anchorLink"));
	       clientpage.getSummaryDetailsFrame();
	       UIUtils.clickElement(driver, TestConfig.getInstance().getObjRep().getLocator("TestClientNew", "MasterfieldsSidemenu"));
	       driver.switchTo().defaultContent();
	       driver.switchTo().frame(driver.findElement(TestConfig.getInstance().getObjRep().getLocator("Newclient", "Addprogram")));
	       UIUtils.clickElement(driver, TestConfig.getInstance().getObjRep().getLocator("TestClientNew", "MasterfieldProgram"));
	       wait.until(ExpectedConditions.invisibilityOf(UIUtils.findElement(driver, TestConfig.getInstance().getObjRep().getLocator("TestClientNew", "MasterfieldProgram"))));
	       driver.switchTo().defaultContent();
	       clientpage.getWork_top_AddnewClient();
	       wait.until(ExpectedConditions.visibilityOf(UIUtils.findElement(driver, TestConfig.getInstance().getObjRep().getLocator("TestClientNew", "ProgramMasterField"))));
	       if(UIUtils.findElement(driver, TestConfig.getInstance().getObjRep().getLocator("TestClientNew", "AssigneeSurvey")).isSelected()==false)
	       {   
	       UIUtils.clickElement(driver, TestConfig.getInstance().getObjRep().getLocator("TestClientNew", "AssigneeSurvey"));
	       }
	       if(UIUtils.findElement(driver, TestConfig.getInstance().getObjRep().getLocator("TestClientNew", "SirvaOnlineExpenses")).isSelected()==false)
	       {
	       UIUtils.clickElement(driver, TestConfig.getInstance().getObjRep().getLocator("TestClientNew", "SirvaOnlineExpenses"));
	       }
	       clientpage.getMyBarFrame();
	       UIUtils.clickElement(driver,TestConfig.getInstance().getObjRep().getLocator("Client", "save"));
	       driver.switchTo().defaultContent();
	       clientpage.getWork_top_AddnewClient();
	       wait.until(ExpectedConditions.visibilityOf(UIUtils.findElement(driver, TestConfig.getInstance().getObjRep().getLocator("TestClientNew", "ProgramMasterField"))));
	       clientpage.getSummaryButtons();
	       UIUtils.clickElement(driver, TestConfig.getInstance().getObjRep().getLocator("TestClientNew", "TestpolicyUP"));
	       Thread.sleep(20000);
	       driver.switchTo().defaultContent();
	       wait.until(ExpectedConditions.frameToBeAvailableAndSwitchToIt(driver.findElement(By.xpath("//div[@id='styled_popup_1']/div[@class='dmode_iframe_container']/iframe"))));
	       driver.switchTo().frame("mechparent");
	       driver.switchTo().frame("mech_work");
	       wait.until(ExpectedConditions.visibilityOf(driver.findElement(By.xpath("//textarea[@name='description']"))));
	       String Policyname=UIUtils.findElement(driver, TestConfig.getInstance().getObjRep().getLocator("Testpolicy", "ProgramName")).getAttribute("value");
	       //Validation of Program Mechanic displayed
	       Assert.assertTrue(driver.findElement(By.xpath("//textarea[@name='description']")).isDisplayed(),"Error in displaying Program Mechanic: Program Mechanic displayed");
	       LOGGER.logTestStep("PASS", "Program Mechanic displayed successfully.");
	       driver.switchTo().parentFrame();
	       driver.switchTo().frame(driver.findElement(TestConfig.getInstance().getObjRep().getLocator("Testpolicy", "mechNavIframe")));
	       UIUtils.clickElement(driver, TestConfig.getInstance().getObjRep().getLocator("Testpolicy", "MasterFields"));
	       wait.until(ExpectedConditions.elementToBeClickable(TestConfig.getInstance().getObjRep().getLocator("Testpolicy", "Setup")));
	       driver.switchTo().parentFrame();
	       wait.until(ExpectedConditions.frameToBeAvailableAndSwitchToIt("mech_work"));
	       wait.until(ExpectedConditions.visibilityOf(UIUtils.findElement(driver, TestConfig.getInstance().getObjRep().getLocator("Masterfields", "WaitElement"))));
	       UIUtils.clickElement(driver, TestConfig.getInstance().getObjRep().getLocator("Masterfields", "Addnew"));
	       driver.switchTo().defaultContent();
	       int i=1; 
			while(i<100000) 
			 {
				  if(driver.findElement(By.xpath("//div[@id='did_appframe_display']/preceding::div[@id='styled_popup_2']/div[@class='dmode_iframe_container']")).isDisplayed())
				  {
					  break;
				  }
				  else 
					  i=i+1;
			  
			 }
			System.out.println(i);
	        wait.until(ExpectedConditions.frameToBeAvailableAndSwitchToIt(driver.findElement(By.xpath("//div[@id='styled_popup_2']/div[@class='dmode_iframe_container']/iframe"))));
	        wait.until(ExpectedConditions.frameToBeAvailableAndSwitchToIt("frame_hdr"));
	        i=1; 
			while(i<10000) 
			 {
				  if(UIUtils.isElementPresent(driver, By.xpath("//b[text()='Edit Master Fields']")))
				  {
					  break;
				  }
				  else 
					  i=i+1;
			  
			 }
			System.out.println(i);
			 driver.switchTo().parentFrame();
	        wait.until(ExpectedConditions.frameToBeAvailableAndSwitchToIt("frame_detail"));
	        wait.until(ExpectedConditions.visibilityOf(UIUtils.findElement(driver, TestConfig.getInstance().getObjRep().getLocator("EditMasterFields", "Name"))));
	        UIUtils.inputText(driver, TestConfig.getInstance().getObjRep().getLocator("EditMasterFields", "Date"), UIUtils.getCurrentDate("MM/dd/yyyy"));
	        UIUtils.inputText(driver, TestConfig.getInstance().getObjRep().getLocator("EditMasterFields", "Name"), TestData.getData("AddClient").get("EditMasterField").toString() + rand.nextInt(1000));
	        
	        driver.switchTo().parentFrame();
	        driver.switchTo().frame("frame_hdr");
	        UIUtils.clickElement(driver, By.xpath("//input[@value='OK' and @name='B3']"));
	        wait.until(ExpectedConditions.invisibilityOf(UIUtils.findElement(driver, TestConfig.getInstance().getObjRep().getLocator("Common", "btnOK"))));
	       
	       
	       
	       
	       

	  }
	  
	  @Test(description="TC_07_Program_Fee_Schedule", enabled=true, priority=1, groups= {"Regression","Client"})
	  public void TC_07_Program_Fee_Schedule() throws Exception
	  {
		  
	  }
	  
	  @AfterMethod
	  public void testResult(Method method, ITestResult result) throws Exception {
		switch (result.getStatus()) {
		case ITestResult.SUCCESS:
			LogMe.getExtentTest().log(LogStatus.PASS, "Test Case " + method.getName() + " is pass");
			break;
		case ITestResult.FAILURE:
			LogMe.getExtentTest().log(LogStatus.FAIL, "Test Case " + method.getName() + " failed");
			break;
		case ITestResult.SKIP:
			LogMe.getExtentTest().log(LogStatus.SKIP, "Test Case " + method.getName() + "  skiped");
			break;
		default:
			break;
		}
		LOGGER.logEndTestCase(method.getName());
		/*login = home.logout();
		// Validation whether login is displaying or not
		Assert.assertTrue(login.isPageOpen());
		driver.quit();*/
	}

	@AfterTest
	public void tearDown() throws Exception {
		
	}

	@AfterSuite
	public void generateResult() {
		try {
			ExtentManager.getInstance().flush();
		} finally {
			ExtentManager.getInstance().close();
		}
	
	}

	@DataProvider(name = "getClientData")
	public Object[][] getAssigneeData() throws IOException {
		String testDataPath = new File("Framework\\Test_Data\\TestData.xlsx").getCanonicalPath();
		return DataLoaders.excelDataLoader(testDataPath, "SearchClient");
	}
}